<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Logan ‚Äì Admin</title>

  <!-- Reuse your existing styles -->
  <link rel="shortcut icon" type="image/x-icon" href="images/favicon.svg">
  <link rel="stylesheet" href="css/global.css">
  <link rel="stylesheet" href="css/home.css">

  <!-- Admin-specific styles -->
  <style>
    .admin-layout {
      min-height: 100vh;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 1.5rem 0;
      background-color: #ff948f;
    }

    .admin-shell {
      background-color: #fffbfa;
      border-radius: 12px;
      border: 0.5px dashed #ff948f;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
      padding: 1.5rem 1.25rem 1.75rem;
      width: min(720px, 100% - 2rem);
      font-size: 0.95rem;
    }

    .admin-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .admin-title {
      margin: 0;
      font-size: 1.2rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .admin-subtitle {
      margin: 0;
      opacity: 0.8;
      font-size: 0.8rem;
    }

    .admin-section {
      margin-top: 1.25rem;
    }

    .admin-login-box {
      border-radius: 8px;
      border: 1px dashed rgba(0, 0, 0, 0.25);
      padding: 0.75rem 0.9rem 0.95rem;
      background: rgba(255, 251, 250, 0.8);
      font-size: 0.85rem;
    }

    .admin-login-box p {
      margin: 0 0 0.5rem;
    }

    .admin-row {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      margin-top: 0.25rem;
    }

    .admin-input,
    .admin-select,
    .admin-textarea {
      width: 100%;
      font: inherit;
      padding: 0.4rem 0.5rem;
      border-radius: 6px;
      border: 1px solid rgba(0, 0, 0, 0.2);
      background: #fffbfa;
    }

    .admin-input:focus,
    .admin-select:focus,
    .admin-textarea:focus {
      outline: 2px solid rgba(0, 0, 0, 0.35);
      outline-offset: 1px;
    }

    .admin-button {
      font: inherit;
      border-radius: 999px;
      border: 1px solid rgba(0, 0, 0, 0.75);
      padding: 0.3rem 0.9rem;
      background: #fffbfa;
      cursor: pointer;
      white-space: nowrap;
    }

    .admin-button:hover {
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
      transform: translateY(-1px);
    }

    .admin-error {
      margin-top: 0.4rem;
      color: #b00020;
      font-size: 0.8rem;
      min-height: 1.2em;
    }

    .admin-panel {
      margin-top: 1.25rem;
    }

    .admin-field {
      margin-bottom: 0.75rem;
    }

    .admin-field label {
      display: block;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      margin-bottom: 0.15rem;
      opacity: 0.8;
    }

    .admin-field-inline {
      display: flex;
      gap: 0.5rem;
    }

    .admin-field-inline > div {
      flex: 1;
    }

    .admin-form {
      display: none;
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px dashed rgba(0, 0, 0, 0.2);
    }

    .admin-form.active {
      display: block;
    }

    .admin-form h2 {
      margin: 0 0 0.4rem;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .admin-hint {
      font-size: 0.75rem;
      opacity: 0.7;
      margin: 0 0 0.4rem;
    }

    .admin-output-section {
      margin-top: 1.25rem;
      border-top: 1px dashed rgba(0, 0, 0, 0.2);
      padding-top: 1rem;
    }

    .admin-output-section h2 {
      margin: 0 0 0.4rem;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .admin-output {
      width: 100%;
      min-height: 8rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.8rem;
      padding: 0.5rem;
      border-radius: 6px;
      border: 1px solid rgba(0, 0, 0, 0.2);
      background: #fff;
      resize: vertical;
    }

    .admin-output-help {
      font-size: 0.75rem;
      opacity: 0.75;
      margin-top: 0.35rem;
    }

    @media (max-width: 600px) {
      .admin-shell {
        padding: 1.25rem 1rem 1.5rem;
      }

      .admin-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>

<body>
  <main class="admin-layout">
    <div class="admin-shell">
      <header class="admin-header">
        <div>
          <h1 class="admin-title">log admin</h1>
          <p class="admin-subtitle">local little CMS for announcements, log links, etc.</p>
        </div>
        <a href="/" class="admin-subtitle" style="text-decoration: none;">‚Üê back home</a>
      </header>

      <!-- Login / password gate -->
      <section id="admin-login" class="admin-section">
        <div class="admin-login-box">
          <p>This page is just for Logan. Enter the admin password to unlock the form wizard.</p>
          <form id="admin-password-form" class="admin-form-login">
            <div class="admin-row">
              <input
                id="admin-password-input"
                class="admin-input"
                type="password"
                autocomplete="current-password"
                placeholder="password"
                required
              >
              <button class="admin-button" type="submit">Unlock</button>
            </div>
            <div id="admin-password-error" class="admin-error"></div>
          </form>
        </div>
      </section>

      <!-- Main panel -->
      <section id="admin-panel" class="admin-section admin-panel" hidden>
        <div class="admin-field">
          <label for="admin-type">What would you like to add?</label>
          <select id="admin-type" class="admin-select">
            <option value="announcement">Announcement</option>
            <option value="portfolio">Portfolio item</option>
            <option value="log">Log link (for /log)</option>
            <option value="explorer">Explorer / link item</option>
          </select>
        </div>

        <!-- Announcement form -->
        <form id="form-announcement" class="admin-form" data-type="announcement">
          <h2>Announcement</h2>
          <p class="admin-hint">Paste this snippet into your announcements section (where you currently show ‚ÄúLoading announcements‚Ä¶‚Äù).</p>

          <div class="admin-field admin-field-inline">
            <div>
              <label for="ann-date">Date</label>
              <input id="ann-date" class="admin-input" type="text" placeholder="2025-11-30">
            </div>
            <div>
              <label for="ann-title">Title</label>
              <input id="ann-title" class="admin-input" type="text" placeholder="Short title">
            </div>
          </div>

          <div class="admin-field">
            <label for="ann-body">Body text</label>
            <textarea id="ann-body" class="admin-textarea" rows="3" placeholder="Details about the announcement‚Ä¶"></textarea>
          </div>

          <div class="admin-field admin-field-inline">
            <div>
              <label for="ann-link-text">Link label (optional)</label>
              <input id="ann-link-text" class="admin-input" type="text" placeholder="More info, tickets, etc.">
            </div>
            <div>
              <label for="ann-link-url">Link URL (optional)</label>
              <input id="ann-link-url" class="admin-input" type="url" placeholder="https://‚Ä¶">
            </div>
          </div>

          <button class="admin-button" type="submit">Generate announcement snippet</button>
        </form>

        <!-- Portfolio form -->
        <form id="form-portfolio" class="admin-form" data-type="portfolio">
          <h2>Portfolio item</h2>
          <p class="admin-hint">This generates a generic ‚Äúcard‚Äù for your work section. You can tweak classes to match your existing HTML.</p>

          <div class="admin-field">
            <label for="port-title">Project title</label>
            <input id="port-title" class="admin-input" type="text" placeholder="Frindlers">
          </div>

          <div class="admin-field admin-field-inline">
            <div>
              <label for="port-subtitle">Subtitle / role</label>
              <input id="port-subtitle" class="admin-input" type="text" placeholder="First Edition (2025)">
            </div>
            <div>
              <label for="port-tagline">Tagline (optional)</label>
              <input id="port-tagline" class="admin-input" type="text" placeholder="Production, engineering, etc.">
            </div>
          </div>

          <div class="admin-field admin-field-inline">
            <div>
              <label for="port-image-url">Image URL</label>
              <input id="port-image-url" class="admin-input" type="url" placeholder="images/frindlers.jpg">
            </div>
            <div>
              <label for="port-image-alt">Image alt text</label>
              <input id="port-image-alt" class="admin-input" type="text" placeholder="Frindlers ‚Äì First Edition cover">
            </div>
          </div>

          <div class="admin-field">
            <label for="port-body">Short description</label>
            <textarea id="port-body" class="admin-textarea" rows="3" placeholder="What you did, why it matters‚Ä¶"></textarea>
          </div>

          <div class="admin-field admin-field-inline">
            <div>
              <label for="port-link-text">Primary link label</label>
              <input id="port-link-text" class="admin-input" type="text" placeholder="Listen ‚Üó">
            </div>
            <div>
              <label for="port-link-url">Primary link URL</label>
              <input id="port-link-url" class="admin-input" type="url" placeholder="https://‚Ä¶">
            </div>
          </div>

          <button class="admin-button" type="submit">Generate portfolio snippet</button>
        </form>

        <!-- Log form -->
        <form id="form-log" class="admin-form" data-type="log">
          <h2>Log link</h2>
          <p class="admin-hint">Generates a new link for <code>/log/index.html</code> inside the ‚Äúlatest‚Ä¶‚Äù section.</p>

          <div class="admin-field">
            <label for="log-href">Entry URL</label>
            <input id="log-href" class="admin-input" type="text" placeholder="entries/2025-12-01-new-piece.html">
          </div>

          <div class="admin-field">
            <label for="log-title">Link text (HTML allowed)</label>
            <input id="log-title" class="admin-input" type="text" placeholder='on &lt;i&gt;some topic&lt;/i&gt;'>
          </div>

          <div class="admin-field">
            <label for="log-classes">Extra classes (optional)</label>
            <input id="log-classes" class="admin-input" type="text" placeholder="fold favorite">
          </div>

          <button class="admin-button" type="submit">Generate log link snippet</button>
        </form>

        <!-- Explorer form -->
        <form id="form-explorer" class="admin-form" data-type="explorer">
          <h2>Explorer / link item</h2>
          <p class="admin-hint">For your ‚Äúmuseum / explore‚Äù style link lists.</p>

          <div class="admin-field">
            <label for="exp-title">Title / label</label>
            <input id="exp-title" class="admin-input" type="text" placeholder="Library of Babel">
          </div>

          <div class="admin-field admin-field-inline">
            <div>
              <label for="exp-url">URL</label>
              <input id="exp-url" class="admin-input" type="url" placeholder="https://‚Ä¶">
            </div>
            <div>
              <label for="exp-note">Short note (optional)</label>
              <input id="exp-note" class="admin-input" type="text" placeholder="tiny description‚Ä¶">
            </div>
          </div>

          <button class="admin-button" type="submit">Generate explorer snippet</button>
        </form>

        <!-- Output -->
        <section class="admin-output-section">
          <h2>Snippet</h2>
          <textarea id="admin-output" class="admin-output" readonly></textarea>
          <p class="admin-output-help">
            Copy this into the appropriate section of your site (announcements, work, log, or explorer) and commit the change.
          </p>
        </section>
      </section>
    </div>
  </main>

  <script>
    (function () {
      const PASSWORD = '5297'; // üîê change this to whatever you want

      const loginSection = document.getElementById('admin-login');
      const panelSection = document.getElementById('admin-panel');
      const pwForm = document.getElementById('admin-password-form');
      const pwInput = document.getElementById('admin-password-input');
      const pwError = document.getElementById('admin-password-error');

      const typeSelect = document.getElementById('admin-type');
      const forms = document.querySelectorAll('.admin-form[data-type]');
      const output = document.getElementById('admin-output');

      // ---- password gate ----
      pwForm.addEventListener('submit', function (e) {
        e.preventDefault();
        const value = pwInput.value.trim();
        if (value === PASSWORD) {
          loginSection.hidden = true;
          panelSection.hidden = false;
          pwError.textContent = '';
          pwInput.value = '';
        } else {
          pwError.textContent = 'Incorrect password.';
        }
      });

      // ---- form switching ----
      function showForm(type) {
        forms.forEach(form => {
          form.classList.toggle('active', form.dataset.type === type);
        });
        output.value = '';
      }

      typeSelect.addEventListener('change', function () {
        showForm(this.value);
      });

      showForm(typeSelect.value);

      // ---- snippet builders ----
      function escapeHtml(str) {
        return str
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;');
      }

      function buildAnnouncementSnippet() {
        const date = document.getElementById('ann-date').value.trim();
        const title = document.getElementById('ann-title').value.trim();
        const body = document.getElementById('ann-body').value.trim();
        const linkText = document.getElementById('ann-link-text').value.trim();
        const linkUrl = document.getElementById('ann-link-url').value.trim();

        const parts = [];
        parts.push('<li class="announcement">');
        if (date || title) {
          parts.push(`  <p><span class="announcement-date">${escapeHtml(date)}</span>${date && title ? ' ¬∑ ' : ''}<strong class="announcement-title">${escapeHtml(title)}</strong></p>`);
        }
        if (body) {
          parts.push(`  <p>${escapeHtml(body)}</p>`);
        }
        if (linkText && linkUrl) {
          parts.push(`  <p><a href="${linkUrl}" target="_blank" rel="noopener noreferrer">${escapeHtml(linkText)}</a></p>`);
        }
        parts.push('</li>');

        return parts.join('\n');
      }

      function buildPortfolioSnippet() {
        const title = document.getElementById('port-title').value.trim();
        const subtitle = document.getElementById('port-subtitle').value.trim();
        const tagline = document.getElementById('port-tagline').value.trim();
        const imageUrl = document.getElementById('port-image-url').value.trim();
        const imageAlt = document.getElementById('port-image-alt').value.trim();
        const body = document.getElementById('port-body').value.trim();
        const linkText = document.getElementById('port-link-text').value.trim();
        const linkUrl = document.getElementById('port-link-url').value.trim();

        const lines = [];
        lines.push('<article class="portfolio-item">');
        if (imageUrl) {
          lines.push('  <figure class="portfolio-image">');
          lines.push(`    <img src="${imageUrl}" alt="${escapeHtml(imageAlt || title)}">`);
          lines.push('  </figure>');
        }
        lines.push('  <div class="portfolio-text">');
        if (title) lines.push(`    <h3>${escapeHtml(title)}</h3>`);
        if (subtitle) lines.push(`    <p class="portfolio-subtitle">${escapeHtml(subtitle)}</p>`);
        if (tagline) lines.push(`    <p class="portfolio-tagline">${escapeHtml(tagline)}</p>`);
        if (body) lines.push(`    <p>${escapeHtml(body)}</p>`);
        if (linkText && linkUrl) {
          lines.push('    <p class="portfolio-links">');
          lines.push(`      <a href="${linkUrl}" target="_blank" rel="noopener noreferrer">${escapeHtml(linkText)}</a>`);
          lines.push('    </p>');
        }
        lines.push('  </div>');
        lines.push('</article>');

        return lines.join('\n');
      }

      function buildLogSnippet() {
        const href = document.getElementById('log-href').value.trim();
        const titleRaw = document.getElementById('log-title').value.trim();
        const classes = document.getElementById('log-classes').value.trim();

        if (!href || !titleRaw) return '';

        const classAttr = classes ? ` class="${classes}"` : '';
        // title may contain HTML (e.g. <i>), so we don't escape it
        return `<a href="${href}"${classAttr}>${titleRaw}</a>`;
      }

      function buildExplorerSnippet() {
        const title = document.getElementById('exp-title').value.trim();
        const url = document.getElementById('exp-url').value.trim();
        const note = document.getElementById('exp-note').value.trim();

        const lines = [];
        lines.push('<li class="explore-item">');
        if (url) {
          lines.push(`  <a href="${url}" target="_blank" rel="noopener noreferrer">`);
          if (title) lines.push(`    <span class="explore-label">${escapeHtml(title)}</span>`);
          if (note) lines.push(`    <span class="explore-note">${escapeHtml(note)}</span>`);
          lines.push('  </a>');
        } else if (title) {
          lines.push(`  <span class="explore-label">${escapeHtml(title)}</span>`);
          if (note) lines.push(`  <span class="explore-note">${escapeHtml(note)}</span>`);
        }
        lines.push('</li>');

        return lines.join('\n');
      }

      const builders = {
        announcement: buildAnnouncementSnippet,
        portfolio: buildPortfolioSnippet,
        log: buildLogSnippet,
        explorer: buildExplorerSnippet
      };

      forms.forEach(form => {
        form.addEventListener('submit', function (e) {
          e.preventDefault();
          const type = this.dataset.type;
          const builder = builders[type];
          if (!builder) return;
          const snippet = builder() || '';
          output.value = snippet;
          if (snippet) {
            output.focus();
            output.select();
          }
        });
      });
    })();
  </script>
</body>
</html>
